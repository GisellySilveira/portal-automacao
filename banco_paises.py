"""
Banco de dados de países com nomes em Português, Inglês e Espanhol + ISO2
"""

PAISES_DATABASE = {
    'AD': ['Andorra', 'Andorra', 'Andorra'],
    'AE': ['United Arab Emirates', 'Emirados Árabes Unidos', 'Emiratos Árabes Unidos'],
    'AF': ['Afghanistan', 'Afeganistão', 'Afganistán'],
    'AG': ['Antigua and Barbuda', 'Antígua e Barbuda', 'Antigua y Barbuda'],
    'AI': ['Anguilla', 'Anguila', 'Anguila'],
    'AL': ['Albania', 'Albânia', 'Albania'],
    'AM': ['Armenia', 'Armênia', 'Armenia'],
    'AO': ['Angola', 'Angola', 'Angola'],
    'AQ': ['Antarctica', 'Antártida', 'Antártida'],
    'AR': ['Argentina', 'Argentina', 'Argentina'],
    'AS': ['American Samoa', 'Samoa Americana', 'Samoa Americana'],
    'AT': ['Austria', 'Áustria', 'Austria'],
    'AU': ['Australia', 'Austrália', 'Australia'],
    'AW': ['Aruba', 'Aruba', 'Aruba'],
    'AZ': ['Azerbaijan', 'Azerbaijão', 'Azerbaiyán'],
    'BA': ['Bosnia and Herzegovina', 'Bósnia e Herzegovina', 'Bosnia y Herzegovina'],
    'BB': ['Barbados', 'Barbados', 'Barbados'],
    'BD': ['Bangladesh', 'Bangladesh', 'Bangladés'],
    'BE': ['Belgium', 'Bélgica', 'Bélgica'],
    'BF': ['Burkina Faso', 'Burkina Faso', 'Burkina Faso'],
    'BG': ['Bulgaria', 'Bulgária', 'Bulgaria'],
    'BH': ['Bahrain', 'Bahrein', 'Baréin'],
    'BI': ['Burundi', 'Burundi', 'Burundi'],
    'BJ': ['Benin', 'Benim', 'Benín'],
    'BL': ['Saint Barthélemy', 'São Bartolomeu', 'San Bartolomé'],
    'BM': ['Bermuda', 'Bermudas', 'Bermudas'],
    'BN': ['Brunei', 'Brunei', 'Brunéi'],
    'BO': ['Bolivia', 'Bolívia', 'Bolivia'],
    'BQ': ['Bonaire, Sint Eustatius and Saba','Bonaire, Santo Eustáquio e Saba','Bonaire, San Eustaquio y Saba' ],
    'BR': ['Brazil', 'Brasil', 'Brasil'],
    'BS': ['Bahamas', 'Bahamas', 'Bahamas'],
    'BT': ['Bhutan', 'Butão', 'Bután'],
    'BV': ['Bouvet Island', 'Ilha Bouvet', 'Isla Bouvet'],
    'BW': ['Botswana', 'Botsuana', 'Botsuana'],
    'BY': ['Belarus', 'Belarus', 'Bielorrusia'],
    'BZ': ['Belize', 'Belize', 'Belice'],
    'CA': ['Canada', 'Canadá', 'Canadá'],
    'CC': ['Cocos Islands', 'Ilhas Cocos', 'Islas Cocos'],
    'CD': ['Democratic Republic of the Congo', 'República Democrática do Congo', 'República Democrática del Congo'],
    'CF': ['Central African Republic', 'República Centro-Africana', 'República Centroafricana'],
    'CG': ['Congo', 'Congo', 'Congo'],
    'CH': ['Switzerland', 'Suíça', 'Suiza'],
    'CI': ['Ivory Coast', 'Costa do Marfim', 'Costa de Marfil'],
    'CK': ['Cook Islands', 'Ilhas Cook', 'Islas Cook'],
    'CL': ['Chile', 'Chile', 'Chile'],
    'CM': ['Cameroon', 'Camarões', 'Camerún'],
    'CN': ['China', 'China', 'China'],
    'CO': ['Colombia', 'Colômbia', 'Colombia'],
    'CR': ['Costa Rica', 'Costa Rica', 'Costa Rica'],
    'CU': ['Cuba', 'Cuba', 'Cuba'],
    'CV': ['Cape Verde', 'Cabo Verde', 'Cabo Verde'],
    'CW': ['Curaçao', 'Curaçao', 'Curazao'],
    'CX': ['Christmas Island', 'Ilha Christmas', 'Isla Christmas'],
    'CY': ['Cyprus', 'Chipre', 'Chipre'],
    'CZ': ['Czech Republic', 'República Tcheca', 'República Checa'],
    'DE': ['Germany', 'Alemanha', 'Alemania'],
    'DJ': ['Djibouti', 'Djibuti', 'Yibuti'],
    'DK': ['Denmark', 'Dinamarca', 'Dinamarca'],
    'DM': ['Dominica', 'Dominica', 'Dominica'],
    'DO': ['Dominican Republic', 'República Dominicana', 'República Dominicana'],
    'DZ': ['Algeria', 'Argélia', 'Argelia'],
    'EC': ['Ecuador', 'Equador', 'Ecuador'],
    'EE': ['Estonia', 'Estônia', 'Estonia'],
    'EG': ['Egypt', 'Egito', 'Egipto'],
    'EH': ['Western Sahara', 'Saara Ocidental', 'Sahara Occidental'],
    'ER': ['Eritrea', 'Eritreia', 'Eritrea'],
    'ES': ['Spain', 'Espanha', 'España'],
    'ET': ['Ethiopia', 'Etiópia', 'Etiopía'],
    'FI': ['Finland', 'Finlândia', 'Finlandia'],
    'FJ': ['Fiji', 'Fiji', 'Fiyi'],
    'FK': ['Falkland Islands', 'Ilhas Malvinas', 'Islas Malvinas'],
    'FM': ['Micronesia', 'Micronésia', 'Micronesia'],
    'FO': ['Faroe Islands', 'Ilhas Faroé', 'Islas Feroe'],
    'FR': ['France', 'França', 'Francia'],
    'GA': ['Gabon', 'Gabão', 'Gabón'],
    'GB': ['United Kingdom', 'Reino Unido', 'Reino Unido'],
    'GD': ['Grenada', 'Granada', 'Granada'],
    'GE': ['Georgia', 'Geórgia', 'Georgia'],
    'GF': ['French Guiana', 'Guiana Francesa', 'Guayana Francesa'],
    'GG': ['Guernsey', 'Guernsey', 'Guernsey'],
    'GH': ['Ghana', 'Gana', 'Ghana'],
    'GI': ['Gibraltar', 'Gibraltar', 'Gibraltar'],
    'GL': ['Greenland', 'Gronelândia', 'Groenlandia'],
    'GM': ['Gambia', 'Gâmbia', 'Gambia'],
    'GN': ['Guinea', 'Guiné', 'Guinea'],
    'GP': ['Guadeloupe', 'Guadalupe', 'Guadalupe'],
    'GQ': ['Equatorial Guinea', 'Guiné Equatorial', 'Guinea Ecuatorial'],
    'GR': ['Greece', 'Grécia', 'Grecia'],
    'GS': ['South Georgia', 'Geórgia do Sul', 'Georgia del Sur'],
    'GT': ['Guatemala', 'Guatemala', 'Guatemala'],
    'GU': ['Guam', 'Guam', 'Guam'],
    'GW': ['Guinea-Bissau', 'Guiné-Bissau', 'Guinea-Bisáu'],
    'GY': ['Guyana', 'Guiana', 'Guyana'],
    'HK': ['Hong Kong', 'Hong Kong', 'Hong Kong'],
    'HM': ['Heard Island and McDonald Islands', 'Ilhas Heard e McDonald', 'Islas Heard y McDonald'],
    'HN': ['Honduras', 'Honduras', 'Honduras'],
    'HR': ['Croatia', 'Croácia', 'Croacia'],
    'HT': ['Haiti', 'Haiti', 'Haití'],
    'HU': ['Hungary', 'Hungria', 'Hungría'],
    'ID': ['Indonesia', 'Indonésia', 'Indonesia'],
    'IE': ['Ireland', 'Irlanda', 'Irlanda'],
    'IL': ['Israel', 'Israel', 'Israel'],
    'IM': ['Isle of Man', 'Ilha de Man', 'Isla de Man'],
    'IN': ['India', 'Índia', 'India'],
    'IO': ['British Indian Ocean Territory', 'Território Britânico do Oceano Índico', 'Territorio Británico del Océano Índico'],
    'IQ': ['Iraq', 'Iraque', 'Irak'],
    'IR': ['Iran', 'Irã', 'Irán'],
    'IS': ['Iceland', 'Islândia', 'Islandia'],
    'IT': ['Italy', 'Itália', 'Italia'],
    'JE': ['Jersey', 'Jersey', 'Jersey'],
    'JM': ['Jamaica', 'Jamaica', 'Jamaica'],
    'JO': ['Jordan', 'Jordânia', 'Jordania'],
    'JP': ['Japan', 'Japão', 'Japón'],
    'KE': ['Kenya', 'Quênia', 'Kenia'],
    'KG': ['Kyrgyzstan', 'Quirguistão', 'Kirguistán'],
    'KH': ['Cambodia', 'Camboja', 'Camboya'],
    'KI': ['Kiribati', 'Kiribati', 'Kiribati'],
    'KM': ['Comoros', 'Comores', 'Comoras'],
    'KN': ['Saint Kitts and Nevis', 'São Cristóvão e Nevis', 'San Cristóbal y Nieves'],
    'KP': ['North Korea', 'Coreia do Norte', 'Corea del Norte'],
    'KR': ['South Korea', 'Coreia do Sul', 'Corea del Sur'],
    'KW': ['Kuwait', 'Kuwait', 'Kuwait'],
    'KY': ['Cayman Islands', 'Ilhas Cayman', 'Islas Caimán'],
    'KZ': ['Kazakhstan', 'Cazaquistão', 'Kazajistán'],
    'LA': ['Laos', 'Laos', 'Laos'],
    'LB': ['Lebanon', 'Líbano', 'Líbano'],
    'LC': ['Saint Lucia', 'Santa Lúcia', 'Santa Lucía'],
    'LI': ['Liechtenstein', 'Liechtenstein', 'Liechtenstein'],
    'LK': ['Sri Lanka', 'Sri Lanka', 'Sri Lanka'],
    'LR': ['Liberia', 'Libéria', 'Liberia'],
    'LS': ['Lesotho', 'Lesoto', 'Lesoto'],
    'LT': ['Lithuania', 'Lituânia', 'Lituania'],
    'LU': ['Luxembourg', 'Luxemburgo', 'Luxemburgo'],
    'LV': ['Latvia', 'Letônia', 'Letonia'],
    'LY': ['Libya', 'Líbia', 'Libia'],
    'MA': ['Morocco', 'Marrocos', 'Marruecos'],
    'MC': ['Monaco', 'Mônaco', 'Mónaco'],
    'MD': ['Moldova', 'Moldávia', 'Moldavia'],
    'ME': ['Montenegro', 'Montenegro', 'Montenegro'],
    'MF': ['Saint Martin', 'São Martinho', 'San Martín'],
    'MG': ['Madagascar', 'Madagascar', 'Madagascar'],
    'MH': ['Marshall Islands', 'Ilhas Marshall', 'Islas Marshall'],
    'MK': ['North Macedonia', 'Macedônia do Norte', 'Macedonia del Norte'],
    'ML': ['Mali', 'Mali', 'Malí'],
    'MM': ['Myanmar', 'Mianmar', 'Birmania'],
    'MN': ['Mongolia', 'Mongólia', 'Mongolia'],
    'MO': ['Macau', 'Macau', 'Macao'],
    'MP': ['Northern Mariana Islands', 'Ilhas Marianas do Norte', 'Islas Marianas del Norte'],
    'MQ': ['Martinique', 'Martinica', 'Martinica'],
    'MR': ['Mauritania', 'Mauritânia', 'Mauritania'],
    'MS': ['Montserrat', 'Montserrat', 'Montserrat'],
    'MT': ['Malta', 'Malta', 'Malta'],
    'MU': ['Mauritius', 'Maurício', 'Mauricio'],
    'MV': ['Maldives', 'Maldivas', 'Maldivas'],
    'MW': ['Malawi', 'Malawi', 'Malaui'],
    'MX': ['Mexico', 'México', 'México'],
    'MY': ['Malaysia', 'Malásia', 'Malasia'],
    'MZ': ['Mozambique', 'Moçambique', 'Mozambique'],
    'NA': ['Namibia', 'Namíbia', 'Namibia'],
    'NC': ['New Caledonia', 'Nova Caledônia', 'Nueva Caledonia'],
    'NE': ['Niger', 'Níger', 'Níger'],
    'NF': ['Norfolk Island', 'Ilha Norfolk', 'Isla Norfolk'],
    'NG': ['Nigeria', 'Nigéria', 'Nigeria'],
    'NI': ['Nicaragua', 'Nicarágua', 'Nicaragua'],
    'NL': ['Netherlands', 'Holanda', 'Países Bajos'],
    'NO': ['Norway', 'Noruega', 'Noruega'],
    'NP': ['Nepal', 'Nepal', 'Nepal'],
    'NR': ['Nauru', 'Nauru', 'Nauru'],
    'NU': ['Niue', 'Niue', 'Niue'],
    'NZ': ['New Zealand', 'Nova Zelândia', 'Nueva Zelanda'],
    'OM': ['Oman', 'Omã', 'Omán'],
    'PA': ['Panama', 'Panamá', 'Panamá'],
    'PE': ['Peru', 'Peru', 'Perú'],
    'PF': ['French Polynesia', 'Polinésia Francesa', 'Polinesia Francesa'],
    'PG': ['Papua New Guinea', 'Papua-Nova Guiné', 'Papúa Nueva Guinea'],
    'PH': ['Philippines', 'Filipinas', 'Filipinas'],
    'PK': ['Pakistan', 'Paquistão', 'Pakistán'],
    'PL': ['Poland', 'Polônia', 'Polonia'],
    'PM': ['Saint Pierre and Miquelon', 'Saint-Pierre e Miquelon', 'San Pedro y Miquelón'],
    'PN': ['Pitcairn Islands', 'Ilhas Pitcairn', 'Islas Pitcairn'],
    'PR': ['Puerto Rico', 'Porto Rico', 'Puerto Rico'],
    'PS': ['Palestine', 'Palestina', 'Palestina'],
    'PT': ['Portugal', 'Portugal', 'Portugal'],
    'PW': ['Palau', 'Palau', 'Palaos'],
    'PY': ['Paraguay', 'Paraguai', 'Paraguay'],
    'QA': ['Qatar', 'Catar', 'Catar'],
    'RE': ['Réunion', 'Reunião', 'Reunión'],
    'RO': ['Romania', 'Romênia', 'Rumania'],
    'RS': ['Serbia', 'Sérvia', 'Serbia'],
    'RU': ['Russia', 'Rússia', 'Rusia'],
    'RW': ['Rwanda', 'Ruanda', 'Ruanda'],
    'SA': ['Saudi Arabia', 'Arábia Saudita', 'Arabia Saudita'],
    'SB': ['Solomon Islands', 'Ilhas Salomão', 'Islas Salomón'],
    'SC': ['Seychelles', 'Seychelles', 'Seychelles'],
    'SD': ['Sudan', 'Sudão', 'Sudán'],
    'SE': ['Sweden', 'Suécia', 'Suecia'],
    'SG': ['Singapore', 'Singapura', 'Singapur'],
    'SH': ['Saint Helena', 'Santa Helena', 'Santa Elena'],
    'SI': ['Slovenia', 'Eslovênia', 'Eslovenia'],
    'SJ': ['Svalbard and Jan Mayen', 'Svalbard e Jan Mayen', 'Svalbard y Jan Mayen'],
    'SK': ['Slovakia', 'Eslováquia', 'Eslovaquia'],
    'SL': ['Sierra Leone', 'Serra Leoa', 'Sierra Leona'],
    'SM': ['San Marino', 'San Marino', 'San Marino'],
    'SN': ['Senegal', 'Senegal', 'Senegal'],
    'SO': ['Somalia', 'Somália', 'Somalia'],
    'SR': ['Suriname', 'Suriname', 'Surinam'],
    'SS': ['South Sudan', 'Sudão do Sul', 'Sudán del Sur'],
    'ST': ['Sao Tome and Principe', 'São Tomé e Príncipe', 'Santo Tomé y Príncipe'],
    'SV': ['El Salvador', 'El Salvador', 'El Salvador'],
    'SX': ['Sint Maarten', 'São Martinho (parte holandesa)', 'San Martín (parte neerlandesa)'],
    'SY': ['Syria', 'Síria', 'Siria'],
    'SZ': ['Eswatini', 'Essuatíni', 'Esuatini'],
    'TC': ['Turks and Caicos Islands', 'Ilhas Turks e Caicos', 'Islas Turcas y Caicos'],
    'TD': ['Chad', 'Chade', 'Chad'],
    'TF': ['French Southern Territories', 'Territórios Franceses do Sul', 'Territorios Franceses del Sur'],
    'TG': ['Togo', 'Togo', 'Togo'],
    'TH': ['Thailand', 'Tailândia', 'Tailandia'],
    'TJ': ['Tajikistan', 'Tajiquistão', 'Tayikistán'],
    'TK': ['Tokelau', 'Tokelau', 'Tokelau'],
    'TL': ['Timor-Leste', 'Timor-Leste', 'Timor Oriental'],
    'TM': ['Turkmenistan', 'Turcomenistão', 'Turkmenistán'],
    'TN': ['Tunisia', 'Tunísia', 'Túnez'],
    'TO': ['Tonga', 'Tonga', 'Tonga'],
    'TR': ['Turkey', 'Turquia', 'Turquía'],
    'TT': ['Trinidad and Tobago', 'Trinidad e Tobago', 'Trinidad y Tobago'],
    'TV': ['Tuvalu', 'Tuvalu', 'Tuvalu'],
    'TW': ['Taiwan', 'Taiwan', 'Taiwán'],
    'TZ': ['Tanzania', 'Tanzânia', 'Tanzania'],
    'UA': ['Ukraine', 'Ucrânia', 'Ucrania'],
    'UG': ['Uganda', 'Uganda', 'Uganda'],
    'UM': ['U.S. Minor Outlying Islands', 'Ilhas Menores dos EUA', 'Islas Ultramarinas Menores de EE. UU.'],
    'US': ['United States', 'Estados Unidos', 'Estados Unidos'],
    'UY': ['Uruguay', 'Uruguai', 'Uruguay'],
    'UZ': ['Uzbekistan', 'Uzbequistão', 'Uzbekistán'],
    'VA': ['Vatican City', 'Vaticano', 'Ciudad del Vaticano'],
    'VC': ['Saint Vincent and the Grenadines', 'São Vicente e Granadinas', 'San Vicente y las Granadinas'],
    'VE': ['Venezuela', 'Venezuela', 'Venezuela'],
    'VG': ['British Virgin Islands', 'Ilhas Virgens Britânicas', 'Islas Vírgenes Británicas'],
    'VI': ['U.S. Virgin Islands', 'Ilhas Virgens Americanas', 'Islas Vírgenes de EE.UU.'],
    'VN': ['Vietnam', 'Vietnã', 'Vietnam'],
    'VU': ['Vanuatu', 'Vanuatu', 'Vanuatu'],
    'WF': ['Wallis and Futuna', 'Wallis e Futuna', 'Wallis y Futuna'],
    'WS': ['Samoa', 'Samoa', 'Samoa'],
    'YE': ['Yemen', 'Iêmen', 'Yemen'],
    'YT': ['Mayotte', 'Mayotte', 'Mayotte'],
    'ZA': ['South Africa', 'África do Sul', 'Sudáfrica'],
    'ZM': ['Zambia', 'Zâmbia', 'Zambia'],
    'ZW': ['Zimbabwe', 'Zimbábue', 'Zimbabue']
}



def buscar_iso_por_nome(nome_pais):
    """
    Busca o código ISO2 de um país pelo nome (em qualquer idioma)
    
    Args:
        nome_pais: Nome do país em Português, Inglês ou Espanhol
    
    Returns:
        Código ISO2 ou None se não encontrado
    """
    nome_pais_lower = nome_pais.lower().strip()
    
    for iso, nomes in PAISES_DATABASE.items():
        for nome in nomes:
            if nome.lower() == nome_pais_lower:
                return iso
    
    return None


def buscar_nome_em_ingles(nome_pais):
    """
    Retorna o nome do país em inglês
    """
    nome_pais_lower = nome_pais.lower().strip()
    
    for iso, nomes in PAISES_DATABASE.items():
        for nome in nomes:
            if nome.lower() == nome_pais_lower:
                return nomes[0]  # Nome em inglês
    
    return nome_pais  # Retorna o original se não encontrar


def processar_tabela_com_banco_paises(df_zonas):
    """
    Processa uma tabela de zonas, adicionando ISO e traduzindo para inglês
    
    Args:
        df_zonas: DataFrame com colunas 'country' e 'zone' (ou similar)
    
    Returns:
        DataFrame com colunas 'country' (em inglês), 'iso', 'zone'
    """
    import pandas as pd
    
    # Identifica a coluna de país (pode ter nomes diferentes)
    coluna_pais = None
    for col in df_zonas.columns:
        if 'countr' in col.lower() or 'pais' in col.lower() or 'país' in col.lower():
            coluna_pais = col
            break
    
    if not coluna_pais:
        raise ValueError("Coluna de país não encontrada. Certifique-se de que há uma coluna com 'country', 'pais' ou 'país' no nome.")
    
    # Identifica a coluna de zona
    coluna_zona = None
    for col in df_zonas.columns:
        if 'zone' in col.lower() or 'zona' in col.lower():
            coluna_zona = col
            break
    
    if not coluna_zona:
        raise ValueError("Coluna de zona não encontrada. Certifique-se de que há uma coluna com 'zone' ou 'zona' no nome.")
    
    # Cria novo DataFrame
    resultado = []
    
    for _, row in df_zonas.iterrows():
        nome_original = str(row[coluna_pais]).strip()
        zona = row[coluna_zona]
        
        # Busca ISO
        iso = buscar_iso_por_nome(nome_original)
        
        # Busca nome em inglês
        nome_ingles = buscar_nome_em_ingles(nome_original)
        
        resultado.append({
            'country': nome_ingles,
            'iso': iso if iso else 'XX',  # XX se não encontrar
            'Zona_Letra': zona
        })
    
    return pd.DataFrame(resultado)




